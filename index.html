<!DOCTYPE html>
<html lang="pl" class="dark">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

        <!-- PWA & macOS Integration -->
        <title>Kora · Cortex</title>
        <meta name="description" content="Profesjonalny system synchronizacji półkul mózgowych." />
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="apple-mobile-web-app-title" content="Kora Cortex">
        <link rel="apple-touch-icon" href="https://img.icons8.com/ios-filled/180/22d3ee/brain.png">

        <!-- Tailwind CSS -->
        <script src="https://cdn.tailwindcss.com"></script>

        <!-- Tone.js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500;700&display=swap" rel="stylesheet" />

        <script>
            tailwind.config = {
                darkMode: 'class',
                theme: {
                    extend: {
                        fontFamily: {
                            sans: ['Inter', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif'],
                            mono: ['JetBrains Mono', 'Menlo', 'Monaco', 'Courier New', 'monospace'],
                        },
                        colors: {
                            zinc: {
                                850: '#1f1f22',
                                925: '#101012',
                            },
                            medical: {
                                400: '#22d3ee', // Cyan-400 (Glow)
                                500: '#06b6d4', // Cyan-500 (Solid)
                                900: '#164e63', // Dark bg
                            }
                        },
                        backgroundImage: {
                            'grid-pattern': "linear-gradient(to right, #27272a 1px, transparent 1px), linear-gradient(to bottom, #27272a 1px, transparent 1px)",
                        },
                        animation: {
                            'breath-grid': 'breathGrid 8s ease-in-out infinite',
                            'fade-in-up': 'fadeInUp 0.8s ease-out forwards',
                            'glitch': 'glitch 1s linear infinite',
                            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        },
                        keyframes: {
                            breathGrid: {
                                '0%, 100%': { opacity: '0.1' },
                                '50%': { opacity: '0.2' },
                            },
                            fadeInUp: {
                                '0%': { opacity: '0', transform: 'translateY(20px)' },
                                '100%': { opacity: '1', transform: 'translateY(0)' },
                            },
                            glitch: {
                                '2%, 64%': { transform: 'translate(2px,0) skew(0deg)' },
                                '4%, 60%': { transform: 'translate(-2px,0) skew(0deg)' },
                                '62%': { transform: 'translate(0,0) skew(5deg)' },
                            }
                        }
                    }
                }
            }
        </script>

        <link rel="stylesheet" href="assets/css/app.css">

    </head>
    <body class="min-h-screen flex flex-col selection:bg-medical-400 selection:text-black font-sans overflow-x-hidden">

        <div class="bg-grid bg-grid-pattern animate-breath-grid"></div>

        <!-- BACKGROUND AUDIO HELPER (For Mobile Lock Screen) -->
        <audio id="silentAudioLoop" loop style="display:none;">
            <source src="data:audio/mp3;base64,//NExAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//NExAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq" type="audio/mpeg">
        </audio>

        <!-- LANDING PAGE (ACCESS GATE) -->
        <section id="landingPage" class="fixed inset-0 z-[200] bg-zinc-950 overflow-y-auto overflow-x-hidden transition-all duration-1000">
            <div class="min-h-full flex flex-col items-center justify-center p-6 py-24 relative">

                <div id="landingGlow" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-medical-400/5 rounded-full blur-[100px] pointer-events-none transition-transform duration-100 ease-out"></div>

                <div class="absolute top-10 left-10 w-64 h-96 opacity-20 pointer-events-none hidden lg:block terminal-log text-[10px] text-medical-400 space-y-1">
                    <div>> SYSTEM_BOOT_SEQUENCE_INIT</div>
                    <div>> CHECKING_NEURAL_INTERFACES... OK</div>
                    <div>> LOADING_WAVEFORM_LIBRARIES... OK</div>
                    <div>> CALIBRATING_OSCILLATORS_L/R... OK</div>
                    <div>> ESTABLISHING_SECURE_Handshake... OK</div>
                    <div>> USER_BIO_METRICS... PENDING</div>
                    <div>> AWAITING_INPUT...</div>
                </div>

                <div class="max-w-5xl w-full space-y-16 relative z-10">

                    <div class="text-center space-y-6 animate-fade-in-up" style="animation-delay: 0.1s;">
                        <div class="inline-flex items-center gap-3 border border-zinc-800 rounded-full px-4 py-1.5 bg-zinc-900/80 backdrop-blur mb-6 hover:border-medical-400/50 transition-colors cursor-default">
                            <span class="relative flex h-2 w-2">
                                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-medical-400 opacity-75"></span>
                                <span class="relative inline-flex rounded-full h-2 w-2 bg-medical-500"></span>
                            </span>
                            <span class="text-[10px] font-mono text-zinc-400 uppercase tracking-widest">System Online v2.7</span>
                        </div>

                        <h1 class="text-6xl md:text-8xl font-bold tracking-tight text-white select-none">
                            <span class="block landing-glitch transition-colors duration-300">Kora Cortex</span>
                            <span class="text-2xl md:text-3xl font-light text-zinc-500 tracking-[0.2em] mt-4 block font-mono">NEURAL ENTRAINMENT</span>
                        </h1>

                        <p class="text-sm md:text-base text-zinc-400 max-w-2xl mx-auto font-light leading-relaxed">
                            Zaawansowana platforma bio-hackingu. Wykorzystaj <span class="text-zinc-200">Binaural Beats</span>, <span class="text-zinc-200">Isochronic Tones</span> oraz <span class="text-zinc-200">Stochastyczny Rezonans</span> do precyzyjnej modulacji stanów świadomości.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in-up" style="animation-delay: 0.3s;">
                        <div class="glass-panel p-8 rounded-2xl border-t border-zinc-700/50 group cursor-default">
                            <div class="w-10 h-10 rounded-lg bg-zinc-900 flex items-center justify-center mb-6 group-hover:bg-medical-900/30 transition-colors border border-zinc-800 group-hover:border-medical-400/30">
                                <svg class="text-zinc-400 group-hover:text-medical-400 transition-colors" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path></svg>
                            </div>
                            <h3 class="text-sm font-bold text-white uppercase tracking-wider mb-3 group-hover:text-medical-400 transition-colors">Głęboka Praca</h3>
                            <p class="text-xs text-zinc-500 leading-relaxed">
                                Protokoły Beta (14-30Hz) i Gamma (40Hz) optymalizują przetwarzanie informacji, wspierając logiczne myślenie i neuroprotekcję.
                            </p>
                        </div>
                        <div class="glass-panel p-8 rounded-2xl border-t border-zinc-700/50 group cursor-default">
                            <div class="w-10 h-10 rounded-lg bg-zinc-900 flex items-center justify-center mb-6 group-hover:bg-medical-900/30 transition-colors border border-zinc-800 group-hover:border-medical-400/30">
                                <svg class="text-zinc-400 group-hover:text-medical-400 transition-colors" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                            </div>
                            <h3 class="text-sm font-bold text-white uppercase tracking-wider mb-3 group-hover:text-medical-400 transition-colors">Baza Wiedzy</h3>
                            <p class="text-xs text-zinc-500 leading-relaxed">
                                Dostęp do pełnego raportu badawczego. Mechanizmy FFR, protokoły Harding FPA i analiza wpływu na układ glimfatyczny.
                            </p>
                        </div>
                        <div class="glass-panel p-8 rounded-2xl border-t border-zinc-700/50 group cursor-default">
                            <div class="w-10 h-10 rounded-lg bg-zinc-900 flex items-center justify-center mb-6 group-hover:bg-medical-900/30 transition-colors border border-zinc-800 group-hover:border-medical-400/30">
                                <svg class="text-zinc-400 group-hover:text-medical-400 transition-colors" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20.354 15.354A9 9 0 0 1 8.646 3.646 9.003 9.003 0 0 0 12 21a9.003 9.003 0 0 0 8.354-5.646z"></path></svg>
                            </div>
                            <h3 class="text-sm font-bold text-white uppercase tracking-wider mb-3 group-hover:text-medical-400 transition-colors">Regeneracja</h3>
                            <p class="text-xs text-zinc-500 leading-relaxed">
                                Fale Delta (0.5-4Hz) i Szum Różowy wspomagają głęboki sen NREM i fizjologiczne oczyszczanie mózgu z toksyn.
                            </p>
                        </div>
                    </div>

                    <div class="flex flex-col items-center gap-6 animate-fade-in-up" style="animation-delay: 0.5s;">
                        <button id="enterSystemBtn" class="group relative inline-flex items-center justify-center px-12 py-5 font-mono font-bold text-black transition-all duration-300 bg-white text-sm rounded-sm uppercase tracking-[0.2em] hover:bg-medical-400 hover:scale-105 hover:shadow-[0_0_30px_rgba(34,211,238,0.6)] focus:outline-none">
                            <span class="mr-2">Inicjuj System</span>
                            <svg class="w-4 h-4 transition-transform duration-300 group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                            <span class="absolute top-0 left-0 w-2 h-2 border-t-2 border-l-2 border-black group-hover:border-white transition-colors"></span>
                            <span class="absolute bottom-0 right-0 w-2 h-2 border-b-2 border-r-2 border-black group-hover:border-white transition-colors"></span>
                        </button>
                        <p class="text-[10px] text-zinc-600 font-mono uppercase flex items-center gap-2">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 18v-6a9 9 0 0 1 18 0v6"></path><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"></path></svg>
                            Wymagane słuchawki stereo
                        </p>
                    </div>
                </div>

                <div class="fixed bottom-0 inset-x-0 p-4 flex justify-between items-end text-[9px] font-mono text-zinc-700 uppercase tracking-widest opacity-50 select-none pointer-events-none z-20 bg-gradient-to-t from-zinc-950 to-transparent">
                    <div class="hidden md:block">SECURE CONNECTION<br>TLS 1.3 / AES-256</div>
                    <div class="text-right">LATENCY: 14ms<br>CORE: STABLE</div>
                </div>
            </div>
        </section>

        <!-- CALIBRATION OVERLAY -->
        <div id="calibrationOverlay" class="fixed inset-0 z-[100] bg-black hidden flex-col items-center justify-center transition-opacity duration-1000">
            <div class="w-64 space-y-4">
                <div class="flex justify-between text-[10px] font-mono text-medical-400 uppercase tracking-widest">
                    <span>System Check</span>
                    <span id="calibPercent">0%</span>
                </div>
                <div class="h-[2px] w-full bg-zinc-900 overflow-hidden">
                    <div id="calibBar" class="h-full bg-medical-400 w-0 shadow-[0_0_10px_rgba(34,211,238,0.8)] transition-all duration-300 ease-out"></div>
                </div>
                <div class="text-[10px] font-mono text-zinc-500 h-4" id="calibText">Initializing Neural Engine...</div>
            </div>
        </div>

        <!-- APP CONTAINER (Hidden initially) -->
        <div id="appInterface" class="opacity-0 transition-opacity duration-1000 hidden">
            <header id="appHeader" class="fixed inset-x-0 top-0 z-50 border-b border-white/5 bg-black/80 backdrop-blur-md h-14 transition-opacity duration-1000">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 h-full flex items-center justify-between">
                    <div class="flex items-center gap-3 cursor-default">
                        <div class="w-8 h-8 rounded bg-zinc-900 flex items-center justify-center border border-white/10 relative overflow-hidden group">
                            <div class="absolute inset-0 bg-medical-400/10 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                            <span class="font-mono text-xs font-bold tracking-tighter text-medical-400">KΩ</span>
                        </div>
                        <div class="flex flex-col justify-center h-full pt-1">
                            <span class="text-[10px] font-bold tracking-[0.25em] uppercase text-zinc-200 leading-none">Cortex</span>
                            <span class="text-[9px] text-zinc-600 uppercase tracking-wider leading-tight mt-0.5">Bio-Entrainment v2.7</span>
                        </div>
                    </div>

                    <div class="flex items-center gap-4">
                        <button id="guideToggle" class="hidden sm:flex items-center gap-2 text-[10px] uppercase tracking-wider text-zinc-400 hover:text-white transition-colors border border-zinc-800 rounded px-3 py-1 hover:border-medical-400/50">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                            <span>Raport</span>
                        </button>
                        <button id="programToggle" class="flex items-center gap-2 text-[10px] uppercase tracking-wider text-zinc-400 hover:text-white transition-colors border border-zinc-800 rounded px-3 py-1 hover:border-medical-400/50">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3l9.5 5.5-9.5 5.5L2.5 8.5 12 3z"></path><path d="M2.5 15.5 12 21l9.5-5.5"></path><path d="m2.5 12 9.5 5.5 9.5-5.5"></path></svg>
                            <span>Programy</span>
                        </button>
                        <button id="safetyToggle" class="hidden sm:flex items-center gap-2 text-[10px] uppercase tracking-wider text-zinc-400 hover:text-white transition-colors border border-zinc-800 rounded px-3 py-1 hover:border-medical-400/50">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                            <span>Bezpieczeństwo</span>
                        </button>
                        <div class="hidden sm:flex items-center gap-3 px-3 py-1.5 rounded-full bg-zinc-925 border border-zinc-800/60">
                            <div id="statusDot" class="w-1.5 h-1.5 rounded-full bg-zinc-600 transition-colors duration-500"></div>
                            <span id="statusText" class="text-[9px] font-mono text-zinc-500 uppercase tracking-widest w-16 text-center">Standby</span>
                        </div>
                        <div class="hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-full bg-zinc-925 border border-zinc-800/60 text-[9px] font-mono text-zinc-500 uppercase tracking-widest">
                            <span class="w-2 h-2 rounded-full bg-medical-900/70"></span>
                            <span id="programStatus">Brak aktywnego programu</span>
                        </div>
                        <button id="settingsToggle" class="p-2 text-zinc-400 hover:text-medical-400 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 0 1 0 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 0 1 0-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /></svg>
                        </button>
                    </div>
                </div>
            </header>

            <main class="min-h-screen pt-20 pb-40 px-4 sm:px-6 relative z-10 flex flex-col items-center">
                <div class="max-w-6xl mx-auto w-full grid grid-cols-1 lg:grid-cols-12 gap-6 flex-grow lg:min-h-[600px] lg:h-auto h-auto">
                    <div id="leftPanel" class="lg:col-span-4 flex flex-col gap-4 order-2 lg:order-1 h-full transition-opacity duration-1000">

                        <section id="circadianWidget" class="glass-panel rounded-xl p-4 shrink-0 border-l-2 border-medical-400 flex items-center justify-between group cursor-pointer hover:bg-medical-900/20 transition-colors">
                            <div>
                                <span class="text-[9px] text-zinc-500 font-bold uppercase tracking-widest block mb-1">Circadian Sync</span>
                                <h3 id="circadianTitle" class="text-sm text-white font-mono">Analiza...</h3>
                            </div>
                            <div class="h-8 w-8 rounded-full bg-medical-900/50 flex items-center justify-center text-medical-400 group-hover:text-white transition-colors">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                            </div>
                        </section>

                        <section class="glass-panel rounded-xl p-1 flex flex-col flex-1 min-h-[300px]">
                            <div class="px-4 py-3 border-b border-white/5 flex justify-between items-center shrink-0">
                                <span class="text-[10px] font-bold text-zinc-500 uppercase tracking-widest">Wybierz Protokół</span>
                                <span class="text-[9px] font-mono text-zinc-600">9 DOSTĘPNYCH</span>
                            </div>
                            <div class="overflow-y-auto flex-1 p-1 space-y-1 custom-scroll" id="modeContainer"></div>
                        </section>

                        <section class="glass-panel rounded-xl p-5 space-y-4 relative overflow-hidden shrink-0">
                            <div class="absolute -right-10 -bottom-10 w-32 h-32 bg-medical-400/5 rounded-full blur-2xl"></div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <span class="text-[9px] uppercase text-zinc-600 font-bold tracking-wider block mb-1">Dudnienie</span>
                                    <span id="realtimeHz" class="text-sm font-mono text-medical-400 transition-all duration-300">-- Hz</span>
                                </div>
                                <div>
                                    <span class="text-[9px] uppercase text-zinc-600 font-bold tracking-wider block mb-1">Tło</span>
                                    <span id="noiseTypeDisplay" class="text-xs font-mono text-zinc-400">Brown Noise</span>
                                </div>
                            </div>
                            <div class="pt-2 flex items-center justify-between">
                                <label class="flex items-center gap-3 cursor-pointer group">
                                    <div class="relative">
                                        <input id="focusLockToggle" type="checkbox" class="sr-only peer">
                                        <div class="w-8 h-4 bg-zinc-800 rounded-full peer peer-focus:ring-1 peer-focus:ring-medical-400/30 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-zinc-500 after:border-zinc-400 after:border after:rounded-full after:h-3 after:w-3 after:transition-all peer-checked:bg-medical-900 peer-checked:after:bg-medical-400"></div>
                                    </div>
                                    <span class="text-[10px] text-zinc-500 uppercase tracking-wider group-hover:text-zinc-300 transition-colors">Focus Lock</span>
                                </label>
                                <span class="text-[9px] text-zinc-700 font-mono">ESC aby przerwać</span>
                            </div>
                        </section>

                        <!-- Hypnos duration selection (visible only for Hypnos mode) -->
                        <section id="hypnosDurationCard" class="glass-panel rounded-xl p-5 space-y-3 relative overflow-hidden shrink-0 hidden">
                            <div class="absolute -right-10 -bottom-10 w-24 h-24 bg-medical-400/5 rounded-full blur-2xl"></div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <h2 class="text-[10px] font-bold text-zinc-500 uppercase tracking-widest mb-1">Hypnos · Czas</h2>
                                    <p class="text-xs text-zinc-400">Wybierz długość sesji i zachowaj w pamięci.</p>
                                </div>
                                <span class="text-[9px] text-medical-400 font-mono">Auto-stop</span>
                            </div>
                            <div class="grid grid-cols-4 gap-2" id="hypnosDurationButtons">
                                <button data-duration="30" class="w-full py-2 text-xs rounded border border-zinc-800 bg-zinc-900/40 text-zinc-300 hover:border-medical-400/40 transition-all">30 min</button>
                                <button data-duration="45" class="w-full py-2 text-xs rounded border border-zinc-800 bg-zinc-900/40 text-zinc-300 hover:border-medical-400/40 transition-all">45 min</button>
                                <button data-duration="90" class="w-full py-2 text-xs rounded border border-zinc-800 bg-zinc-900/40 text-zinc-300 hover:border-medical-400/40 transition-all">90 min</button>
                                <button data-duration="infinity" class="w-full py-2 text-xs rounded border border-zinc-800 bg-zinc-900/40 text-zinc-300 hover:border-medical-400/40 transition-all">∞ noc</button>
                            </div>
                        </section>
                    </div>

                    <div class="lg:col-span-8 flex flex-col gap-4 order-1 lg:order-2 h-full">
                        <div id="visualizer" class="relative w-full flex-1 min-h-[300px] rounded-2xl bg-black overflow-hidden border border-zinc-800 shadow-2xl group ring-1 ring-white/5 aspect-square sm:aspect-video lg:aspect-auto">
                            <div class="scanline absolute inset-0 pointer-events-none"></div>
                            <canvas id="visualCanvas" class="absolute inset-0 w-full h-full opacity-0 transition-opacity duration-1000"></canvas>

                            <div id="message-box" class="absolute inset-0 flex flex-col items-center justify-center p-6 text-center z-10 bg-black/40 backdrop-blur-sm transition-all duration-700">
                                <div class="w-14 h-14 mb-5 rounded-full border border-zinc-800 flex items-center justify-center relative group-hover:border-medical-400/30 transition-colors duration-500">
                                    <div class="absolute inset-0 border border-medical-400/20 rounded-full animate-ping opacity-20"></div>
                                    <svg class="w-6 h-6 text-zinc-500 group-hover:text-medical-400 transition-colors duration-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.25">
                                        <circle cx="12" cy="12" r="7" />
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9.5v4.75" />
                                        <circle cx="12" cy="16.5" r="0.65" fill="currentColor" />
                                    </svg>
                                </div>
                                <div class="space-y-2 max-w-xl">
                                    <h1 id="messageTitle" class="text-2xl font-light text-white tracking-tight">Kora <span class="font-bold text-medical-400">Cortex</span></h1>
                                    <p id="modeDesc" class="text-sm text-zinc-300 leading-relaxed font-light">System gotowy. Wymagane słuchawki stereo.</p>
                                </div>
                            </div>

                            <div id="programOverlay" class="absolute inset-0 hidden flex items-center justify-center p-4 z-30">
                                <div class="glass-panel rounded-xl border border-medical-400/20 bg-black/70 max-w-xl w-full p-6 space-y-4">
                                    <div class="flex items-start gap-3">
                                        <div class="w-8 h-8 rounded-full bg-medical-900/60 border border-medical-500/50 flex items-center justify-center text-medical-400">
                                            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 5v14M5 12h14" stroke-linecap="round" /></svg>
                                        </div>
                                        <div class="space-y-1">
                                            <p id="programOverlayLabel" class="text-[11px] font-mono uppercase tracking-[0.2em] text-medical-400">Program</p>
                                            <h3 id="programOverlayTitle" class="text-lg font-semibold text-white">Następny etap programu</h3>
                                            <p id="programOverlayBody" class="text-sm text-zinc-300 leading-relaxed"></p>
                                        </div>
                                    </div>
                                    <div class="bg-zinc-900/40 border border-zinc-800 rounded-lg p-3">
                                        <div id="programOverlayStep" class="text-sm text-white font-medium"></div>
                                        <p id="programOverlayStepMeta" class="text-xs text-zinc-400"></p>
                                    </div>
                                    <div class="flex flex-wrap gap-2 justify-end">
                                        <button id="programEndBtn" class="px-3 py-2 text-xs uppercase tracking-wider border border-zinc-700 rounded text-zinc-300 hover:text-white hover:border-red-400/70 transition-colors">Zakończ program</button>
                                        <button id="programContinueBtn" class="px-3 py-2 text-xs uppercase tracking-wider bg-medical-400 text-black rounded shadow-[0_0_14px_rgba(34,211,238,0.35)] hover:shadow-[0_0_18px_rgba(34,211,238,0.55)] transition-all">Start kolejnego etapu</button>
                                    </div>
                                </div>
                            </div>

                            <div class="absolute top-4 right-4 z-20 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                <button id="fullscreenButton" class="p-2 rounded bg-black/60 hover:bg-zinc-800 text-zinc-400 hover:text-medical-400 border border-zinc-700 backdrop-blur transition-all">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
                                </button>
                            </div>
                            <div class="absolute bottom-0 left-0 right-0 h-[3px] bg-zinc-900 z-20">
                                <div id="progressBar" class="h-full bg-medical-400 shadow-[0_0_15px_rgba(34,211,238,0.8)] w-0 transition-all duration-300 ease-linear"></div>
                            </div>
                        </div>

                        <div id="controlPanel" class="glass-panel rounded-2xl px-6 py-4 flex items-center justify-between gap-6 shrink-0 h-auto sm:h-24 flex-wrap sm:flex-nowrap transition-all duration-1000">
                            <div class="flex flex-col justify-center min-w-[100px]">
                                <div id="timer" class="font-mono text-4xl text-white tracking-tighter tabular-nums transition-all duration-300">00:00</div>
                            </div>
                            <div class="hidden md:flex flex-col items-start px-6 border-l border-zinc-800/50 flex-1">
                                <span class="text-[9px] uppercase text-zinc-600 font-bold tracking-widest mb-1">Aktualna Faza</span>
                                <span id="currentPhaseName" class="text-sm text-zinc-300 truncate">Oczekiwanie na start</span>
                            </div>
                            <div class="flex items-center gap-3 w-full sm:w-auto mt-2 sm:mt-0">
                                <button id="previewButton" class="hidden sm:block px-5 py-3 rounded border border-zinc-700 text-[10px] font-bold uppercase tracking-wider text-zinc-400 hover:text-white hover:bg-zinc-800 transition-all">
                                    Test Wizualny
                                </button>
                                <button id="mainActionBtn" class="flex-1 sm:flex-none px-8 py-3 rounded bg-zinc-100 hover:bg-white active:scale-95 text-black text-xs font-bold uppercase tracking-widest transition-all shadow-[0_0_20px_rgba(255,255,255,0.05)] min-w-[120px]">
                                    Uruchom
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <footer id="appFooter" class="w-full px-4 relative z-0 mt-24 transition-opacity duration-1000">
                    <div class="border-t border-zinc-900 pt-6 pb-12 text-center backdrop-blur-sm">
                        <p class="text-[9px] text-zinc-600 uppercase tracking-widest max-w-2xl mx-auto leading-relaxed">Sprawdź zakładkę „Bezpieczeństwo” w górnym menu, aby poznać pełne wytyczne korzystania.</p>
                    </div>
                </footer>
            </main>
        </div>

        <!-- SETTINGS MODAL -->
        <div id="settingsModal" class="fixed inset-0 z-[60] bg-black/90 backdrop-blur hidden items-center justify-center p-4">
            <div class="bg-zinc-900 border border-zinc-700 rounded-lg w-full max-w-sm p-6 shadow-2xl relative">
                <button id="closeSettings" class="absolute top-4 right-4 text-zinc-500 hover:text-white">✕</button>
                <h3 class="text-sm font-bold text-white uppercase tracking-widest mb-6 border-b border-zinc-800 pb-2">Konfiguracja</h3>

                <div class="space-y-6">
                    <div>
                        <label class="text-[10px] uppercase text-zinc-500 font-bold tracking-widest block mb-3">Asystent</label>
                        <label class="flex items-center gap-3 cursor-pointer group p-3 border border-zinc-800 bg-zinc-900/50 rounded-lg hover:border-zinc-700 transition-colors">
                            <div class="relative">
                                <input id="breathToggle" type="checkbox" class="sr-only peer">
                                <div class="w-8 h-4 bg-zinc-800 rounded-full peer peer-focus:ring-1 peer-focus:ring-medical-400/30 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-zinc-500 after:border-zinc-400 after:border after:rounded-full after:h-3 after:w-3 after:transition-all peer-checked:bg-medical-900 peer-checked:after:bg-medical-400"></div>
                            </div>
                            <div>
                                <span class="block text-xs text-zinc-200 group-hover:text-white transition-colors">Asystent Oddechu</span>
                                <span id="breathPatternSummary" class="block text-[9px] text-zinc-500 mt-0.5">Rytm 4s/6s lub automatyczny wg protokołu.</span>
                            </div>
                        </label>

                        <div class="mt-3">
                            <label class="text-[10px] uppercase text-zinc-500 font-bold tracking-widest block mb-2">Styl oddechu</label>
                            <div class="grid grid-cols-2 gap-2" id="breathPatternButtons">
                                <button data-pattern="auto" class="breath-pattern-btn py-2 border border-zinc-700 bg-zinc-800 rounded text-[11px] text-zinc-300 hover:text-white transition-all">Auto (wg trybu)</button>
                                <button data-pattern="4-6" class="breath-pattern-btn py-2 border border-zinc-700 bg-zinc-800 rounded text-[11px] text-zinc-300 hover:text-white transition-all">4–6</button>
                                <button data-pattern="4-7-8" class="breath-pattern-btn py-2 border border-zinc-700 bg-zinc-800 rounded text-[11px] text-zinc-300 hover:text-white transition-all">4–7–8</button>
                                <button data-pattern="box" class="breath-pattern-btn py-2 border border-zinc-700 bg-zinc-800 rounded text-[11px] text-zinc-300 hover:text-white transition-all">Box 4–4–4–4</button>
                            </div>
                            <p id="breathPatternHelper" class="text-[10px] text-zinc-500 mt-2">Auto dopasuje wzorzec do wybranego trybu.</p>
                        </div>
                    </div>

                    <div>
                        <label class="text-[10px] uppercase text-zinc-500 font-bold tracking-widest block mb-3">Kolor Szumu (Tło)</label>
                        <div class="grid grid-cols-2 gap-3">
                            <button id="setPinkNoise" class="noise-btn py-3 border border-zinc-700 bg-zinc-800 rounded text-xs text-zinc-300 hover:text-white transition-all active-noise">Różowy</button>
                            <button id="setBrownNoise" class="noise-btn py-3 border border-zinc-700 bg-zinc-800 rounded text-xs text-zinc-300 hover:text-white transition-all">Brązowy</button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <label class="flex items-center gap-3 cursor-pointer group p-3 border border-zinc-800 bg-zinc-900/50 rounded-lg hover:border-zinc-700 transition-colors">
                            <div class="relative">
                                <input id="safeVisualsToggle" type="checkbox" class="sr-only peer">
                                <div class="w-8 h-4 bg-zinc-800 rounded-full peer peer-focus:ring-1 peer-focus:ring-medical-400/30 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-zinc-500 after:border-zinc-400 after:border after:rounded-full after:h-3 after:w-3 after:transition-all peer-checked:bg-medical-900 peer-checked:after:bg-medical-400"></div>
                            </div>
                            <div>
                                <span class="block text-xs text-zinc-200 group-hover:text-white transition-colors">Safe Visuals</span>
                                <span class="block text-[9px] text-zinc-500 mt-0.5">Ogranicz migotanie i kontrast.</span>
                            </div>
                        </label>

                        <label class="flex items-center gap-3 cursor-pointer group p-3 border border-zinc-800 bg-zinc-900/50 rounded-lg hover:border-zinc-700 transition-colors">
                            <div class="relative">
                                <input id="audioOnlyToggle" type="checkbox" class="sr-only peer">
                                <div class="w-8 h-4 bg-zinc-800 rounded-full peer peer-focus:ring-1 peer-focus:ring-medical-400/30 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-zinc-500 after:border-zinc-400 after:border after:rounded-full after:h-3 after:w-3 after:transition-all peer-checked:bg-medical-900 peer-checked:after:bg-medical-400"></div>
                            </div>
                            <div>
                                <span class="block text-xs text-zinc-200 group-hover:text-white transition-colors">Tryb Tylko Audio</span>
                                <span class="block text-[9px] text-zinc-500 mt-0.5">Statyczne tło bez animacji.</span>
                            </div>
                        </label>
                    </div>

                    <div>
                        <label class="text-[10px] uppercase text-zinc-500 font-bold tracking-widest block mb-3">Poziom Intensywności</label>
                        <div class="grid grid-cols-3 gap-3" id="intensityButtons">
                            <button data-intensity="low" class="intensity-btn py-3 border border-zinc-700 bg-zinc-800 rounded text-xs text-zinc-300 hover:text-white transition-all">Low</button>
                            <button data-intensity="medium" class="intensity-btn py-3 border border-zinc-700 bg-zinc-800 rounded text-xs text-zinc-300 hover:text-white transition-all">Medium</button>
                            <button data-intensity="high" class="intensity-btn py-3 border border-zinc-700 bg-zinc-800 rounded text-xs text-zinc-300 hover:text-white transition-all">High</button>
                        </div>
                        <p class="text-[10px] text-zinc-500 mt-2">Skaluje głośność kanałów L/R i separację częstotliwości.</p>
                    </div>

                    <div>
                        <label class="text-[10px] uppercase text-zinc-500 font-bold tracking-widest block mb-3">Kalibracja Audio</label>
                        <div class="grid grid-cols-2 gap-3">
                            <button id="testLeftButton" class="py-2 border border-zinc-700 bg-zinc-800 rounded text-xs text-zinc-300 hover:bg-zinc-700 transition-colors">Lewy</button>
                            <button id="testRightButton" class="py-2 border border-zinc-700 bg-zinc-800 rounded text-xs text-zinc-300 hover:bg-zinc-700 transition-colors">Prawy</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GUIDE MODAL -->
        <div id="guideModal" class="fixed inset-0 z-[70] bg-black/95 backdrop-blur-sm hidden items-center justify-center p-4 sm:p-8">
            <div class="bg-zinc-950 border border-zinc-800 rounded-xl w-full max-w-5xl h-full max-h-[90vh] shadow-2xl relative flex flex-col ring-1 ring-white/10">
                <div class="flex items-center justify-between px-8 py-6 border-b border-zinc-800 bg-zinc-950/50 shrink-0">
                    <div>
                        <h3 class="text-xl font-mono text-medical-400 tracking-tight flex items-center gap-3">
                            <span class="w-2 h-2 bg-medical-400 rounded-full animate-pulse"></span>
                            RAPORT BADAWCZY KORA CORTEX
                        </h3>
                        <p class="text-xs text-zinc-500 uppercase tracking-widest mt-1">Neurotechnologia Cyfrowa i Modulacja Fal Mózgowych</p>
                    </div>
                    <button id="closeGuide" class="p-2 text-zinc-500 hover:text-white border border-transparent hover:border-zinc-700 rounded transition-all">
                        <span class="text-xs font-mono uppercase mr-2">Zamknij</span> ✕
                    </button>
                </div>
                <div class="flex-1 overflow-y-auto p-8 sm:p-12 doc-scroll">
                    <div class="max-w-3xl mx-auto space-y-12 text-zinc-300 leading-relaxed font-light">
                        <section>
                            <h4 class="text-2xl font-light text-white mb-6 border-b border-zinc-800 pb-2">Wstęp: Ewolucja Paradygmatu</h4>
                            <p class="mb-4">Niniejszy raport stanowi kompleksowy wsad merytoryczny do dokumentacji technicznej projektu "Kora Cortex". Dokument ten, opracowany z perspektywy Senior Neuroscientist i Data Researcher, ma na celu dostarczenie rygorystycznej analizy mechanizmów biofizycznych i neurofizjologicznych leżących u podstaw technologii entrainmentu fal mózgowych (Brainwave Entrainment – BWE). W obliczu dynamicznego rozwoju sektora cyfrowych terapeutyków (DTx) oraz rosnącej świadomości w zakresie neuroplastyczności i higieny psychicznej, "Kora Cortex" aspiruje do roli precyzyjnego instrumentu neuromodulacji, wykraczającego poza konwencjonalne aplikacje relaksacyjne. Analiza opiera się na systematycznym przeglądzie literatury, obejmującym badania nad odpowiedzią podążania za częstotliwością (Frequency Following Response – FFR), stochastycznym rezonansem, dynamiką układu glimfatycznego oraz wpływem specyficznych pasm częstotliwości na kognicję i neuroprotekcję.</p>
                            <p class="text-sm bg-zinc-900/50 p-4 border-l-2 border-medical-400 text-zinc-400">Współczesna neuronauka przechodzi transformację, w której niefarmakologiczne metody interwencji, takie jak stymulacja sensoryczna, zyskują status klinicznie weryfikowalnych narzędzi. Celem niniejszego opracowania jest zdefiniowanie naukowych fundamentów dla algorytmów "Kora Cortex", krytyczna ocena skuteczności różnych modalności stymulacji (dudnienia różnicowe vs. tony izochroniczne) oraz wyznaczenie rygorystycznych granic bezpieczeństwa, w tym dla fotostymulacji, zgodnie z międzynarodowymi standardami medycznymi.</p>
                        </section>
                        <section>
                            <h4 class="text-xl font-mono text-medical-400 mb-4 mt-8">1. Neurofizjologiczne Podstawy Entrainmentu</h4>
                            <h5 class="text-lg text-white font-medium mb-2">1.1 Dynamika FFR</h5>
                            <p class="mb-4">
                                Fundamentem działania aplikacji klasyfikowanych jako "Digital Drug" lub narzędzia bio-hakingowe jest zjawisko odpowiedzi podążania za częstotliwością (Frequency Following Response – FFR). Jest to wskaźnik wierności kodowania neuronalnego, który odzwierciedla zdolność układu nerwowego do synchronizacji wewnętrznych oscylacji z periodycznym bodźcem zewnętrznym. Współczesne badania (Coffey et al., 2021) zrewolucjonizowały podejście, dowodząc znaczącego udziału kory słuchowej w generowaniu FFR, co implikuje wpływ na wyższe funkcje poznawcze.
                            </p>
                            <h5 class="text-lg text-white font-medium mb-2 mt-6">1.2 Ścieżki Przetwarzania Sygnału</h5>
                            <p class="mb-4">Skuteczność entrainmentu zależy bezpośrednio od tego, w jaki sposób sygnał akustyczny jest przetwarzany na drodze od ślimaka do kory słuchowej.</p>
                            <ul class="list-disc list-outside ml-5 space-y-2 text-sm text-zinc-400">
                                <li><strong class="text-zinc-200">Binaural Beats:</strong> Konstrukt percepcyjny w oliwie górnej (pień mózgu). Wymaga słuchawek.</li>
                                <li><strong class="text-zinc-200">Isochronic Tones:</strong> Fizyczne modulacje kodowane w ślimaku. Silniejsza synchronizacja wzgórzowo-korowa.</li>
                            </ul>
                        </section>
                        <section>
                            <h4 class="text-xl font-mono text-medical-400 mb-4 mt-8">2. Architektura Audytywna</h4>
                            <div class="overflow-x-auto border border-zinc-800 rounded bg-zinc-900/30">
                                <table class="science-table">
                                    <thead><tr><th>Metoda</th><th>Mechanizm</th><th>Efektywność</th><th>Zastosowanie w Kora</th></tr></thead>
                                    <tbody>
                                        <tr><td>Binaural Beats</td><td>Oliwa górna (pień).</td><td>Umiarkowana.</td><td>Relaks, Delta/Theta.</td></tr>
                                        <tr><td>Isochronic Tones</td><td>Wzgórze.</td><td>Wysoka.</td><td>Gamma/Beta, Energetyzacja.</td></tr>
                                        <tr><td>Pink Noise</td><td>Stochastyczny Rezonans.</td><td>Wsparcie snu.</td><td>Maskowanie tła.</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                        <section>
                            <h4 class="text-xl font-mono text-medical-400 mb-4 mt-8">3. Spektrum Częstotliwości i Zastosowania</h4>
                            <div class="grid gap-6">
                                <div class="border border-zinc-800 p-5 rounded bg-zinc-900/20">
                                    <h5 class="text-white font-bold text-sm uppercase tracking-wider mb-2">Gamma (30-100 Hz): Neuroprotekcja</h5>
                                    <p class="text-sm text-zinc-400">Metoda GENUS (MIT). Stymulacja 40 Hz wpływa na mikroglej, zwiększając fagocytozę beta-amyloidu. Moduluje układ naczyniowy (wazodylatacja), wspierając "higienę neuronalną".</p>
                                </div>
                                <div class="border border-zinc-800 p-5 rounded bg-zinc-900/20">
                                    <h5 class="text-white font-bold text-sm uppercase tracking-wider mb-2">Delta (0.5-4 Hz): Układ Glimfatyczny</h5>
                                    <p class="text-sm text-zinc-400">Podczas snu NREM przestrzeń śródmiąższowa ekspanduje o 60% (Xie et al., 2013). Wolne oscylacje działają jak pompa hydrauliczna dla płynu CSF, wypłukując neurotoksyny.</p>
                                </div>
                                <div class="border border-zinc-800 p-5 rounded bg-zinc-900/20">
                                    <h5 class="text-white font-bold text-sm uppercase tracking-wider mb-2">Alpha (8-12 Hz): Flow State</h5>
                                    <p class="text-sm text-zinc-400">Związane z <em>transient hypofrontality</em> - przejściowym wyciszeniem kory przedczołowej. Kluczowe dla "odprężonej czujności".</p>
                                </div>
                            </div>
                        </section>
                        <section>
                            <h4 class="text-xl font-mono text-medical-400 mb-4 mt-8">4. Bezpieczeństwo: Protokół Harding FPA</h4>
                            <p class="mb-4 text-sm">Wdrożenie modułów wizualnych wymaga rygorystycznego przestrzegania standardów prewencji epilepsji fotogennej (PSE).</p>
                            <ul class="list-disc list-inside text-sm space-y-2 text-zinc-400 bg-red-900/10 p-4 border border-red-900/30 rounded">
                                <li><strong>Częstotliwość:</strong> Unikać silnego migotania 15-25 Hz (szczyt ryzyka).</li>
                                <li><strong>Luminancja:</strong> Limit zmiany luminancji < 20 cd/m².</li>
                                <li><strong>Red Flash:</strong> Max 3 przejścia do nasyconej czerwieni na sekundę.</li>
                            </ul>
                        </section>
                        <section class="border-t border-zinc-800 pt-8 mt-12"><h4 class="text-xs font-bold text-zinc-500 uppercase tracking-widest mb-6">Wybrana Bibliografia</h4><ul class="text-[10px] text-zinc-500 space-y-2 font-mono"><li>[1] Coffey et al. (2021). Oscillatory Entrainment of the Frequency-following Response.</li><li>[9] Guillot et al. (2024). Brain wave modulation and EEG power changes...</li><li>[19] Xie et al. (2013). Sleep Drives Metabolite Clearance from the Adult Brain.</li><li>[20] Tsai et al. (2025). Evidence that 40Hz gamma stimulation promotes brain health. MIT News.</li><li>[44] Harding FPA Guidelines for Photosensitive Epilepsy.</li></ul></section>
                    </div>
                </div>
            </div>
        </div>

        <!-- SAFETY MODAL -->
        <div id="safetyModal" class="fixed inset-0 z-[70] bg-black/95 backdrop-blur-sm hidden items-center justify-center p-4 sm:p-8">
            <div class="bg-zinc-950 border border-zinc-800 rounded-xl w-full max-w-3xl h-full max-h-[85vh] shadow-2xl relative flex flex-col ring-1 ring-white/10">
                <div class="flex items-center justify-between px-8 py-6 border-b border-zinc-800 bg-zinc-950/50 shrink-0">
                    <div>
                        <h3 class="text-xl font-mono text-medical-400 tracking-tight flex items-center gap-3">
                            <span class="w-2 h-2 bg-medical-400 rounded-full animate-pulse"></span>
                            Instrukcja Bezpieczeństwa
                        </h3>
                        <p class="text-xs text-zinc-500 uppercase tracking-widest mt-1">Wytyczne przed uruchomieniem wizualizacji i audio</p>
                    </div>
                    <button id="closeSafety" class="p-2 text-zinc-500 hover:text-white border border-transparent hover:border-zinc-700 rounded transition-all">
                        <span class="text-xs font-mono uppercase mr-2">Zamknij</span> ✕
                    </button>
                </div>
                <div class="flex-1 overflow-y-auto p-8 doc-scroll text-sm leading-relaxed space-y-6 text-zinc-300">
                    <div class="bg-red-900/10 border border-red-900/40 rounded p-4 text-red-200 font-semibold uppercase tracking-widest text-[11px]">UWAGA: Silne bodźce wizualne i dźwiękowe. Nie używać w przypadku epilepsji fotogennej ani podczas prowadzenia pojazdów.</div>
                    <section class="space-y-2">
                        <h4 class="text-lg text-white font-semibold">Przeciwwskazania</h4>
                        <ul class="list-disc list-inside space-y-1 text-zinc-400">
                            <li>Nadwrażliwość na światło (PSE), stany po urazach neurologicznych, migreny z aurą.</li>
                            <li>Stosowanie leków obniżających próg drgawkowy – skonsultuj użycie z lekarzem.</li>
                            <li>Zmęczenie, odwodnienie lub brak snu mogą zwiększać dyskomfort sensoryczny.</li>
                        </ul>
                    </section>
                    <section class="space-y-2">
                        <h4 class="text-lg text-white font-semibold">Zasady korzystania</h4>
                        <ul class="list-disc list-inside space-y-1 text-zinc-400">
                            <li>Zawsze używaj słuchawek stereo i zaczynaj od niskiej głośności.</li>
                            <li>Włącz „Safe visuals” lub „Audio-only” przy pierwszym użyciu lub przy wrażliwości na bodźce.</li>
                            <li>Przerwij sesję przy zawrotach głowy, mdłościach, mroczkach lub dyskomforcie.</li>
                            <li>Unikaj patrzenia w jasne źródła światła w zaciemnionych pomieszczeniach podczas intensywnych protokołów.</li>
                        </ul>
                    </section>
                    <section class="space-y-2">
                        <h4 class="text-lg text-white font-semibold">Wskazówki praktyczne</h4>
                        <ul class="list-disc list-inside space-y-1 text-zinc-400">
                            <li>Przed snem wybieraj łagodne tryby (Hypnos/Restoration) i unikaj światła niebieskiego.</li>
                            <li>Rób przerwy między sesjami (min. 10 minut) i nawadniaj się.</li>
                            <li>Testuj kanały L/R w ustawieniach przed dłuższymi sesjami.</li>
                        </ul>
                    </section>
                </div>
            </div>
        </div>

        <!-- PROGRAMS MODAL -->
        <div id="programModal" class="fixed inset-0 z-[70] bg-black/95 backdrop-blur-sm hidden items-center justify-center p-4 sm:p-8">
            <div class="bg-zinc-950 border border-zinc-800 rounded-xl w-full max-w-5xl h-full max-h-[85vh] shadow-2xl relative flex flex-col ring-1 ring-white/10">
                <div class="flex items-center justify-between px-8 py-6 border-b border-zinc-800 bg-zinc-950/50 shrink-0">
                    <div>
                        <h3 class="text-xl font-mono text-medical-400 tracking-tight flex items-center gap-3">
                            <span class="w-2 h-2 bg-medical-400 rounded-full animate-pulse"></span>
                            Programy Kora
                        </h3>
                        <p class="text-xs text-zinc-500 uppercase tracking-widest mt-1">Sekwencje kilku protokołów z pauzą między krokami.</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-full bg-zinc-925 border border-zinc-800/60 text-[10px] font-mono text-zinc-400 uppercase tracking-widest">
                            <span class="w-2 h-2 rounded-full bg-medical-900/70"></span>
                            <span id="programStatusModal">Brak aktywnego programu</span>
                        </div>
                        <button id="closeProgram" class="p-2 text-zinc-500 hover:text-white border border-transparent hover:border-zinc-700 rounded transition-all">
                            <span class="text-xs font-mono uppercase mr-2">Zamknij</span> ✕
                        </button>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto p-8 doc-scroll">
                    <div id="programList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>
            </div>
        </div>

        <script src="assets/js/app.js"></script>

    </body>
</html>
